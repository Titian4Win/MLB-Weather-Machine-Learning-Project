{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2022-05-10T20:33:15.214546Z",
     "iopub.status.busy": "2022-05-10T20:33:15.213850Z",
     "iopub.status.idle": "2022-05-10T20:33:15.251412Z",
     "shell.execute_reply": "2022-05-10T20:33:15.250531Z",
     "shell.execute_reply.started": "2022-05-10T20:33:15.214397Z"
    }
   },
   "outputs": [],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1. If your outcome variable is continuous you will choose Regressor models (XgboostRegressor, RandomForestRegressor). if binary, classifier(RandomForestClassifier, etc. )\n",
    "2. ROC AUC, Accuracy is for classification, RMSE is for regressor. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Description"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "2016 MLB Season\n",
    "162 games\n",
    "Includes many addition variables such as weather and attendance\n",
    "Thirty teams from the United States and one from Canada\n",
    "Data from baseball-reference.com"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Within Weather"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "There are two important variables that affect the outcomes in baseball games, wind speed and wind direction. In theory, the wind speed with hamper the ball from going as far if the wind direction is blowing in the opposite direction of the ball being hit and vice versa."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Question"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The goal in baseball is to reach homebase. Each time a player reaches homebase the team scores a run. Wind speed inpacting how far the ball travels impact the distance at which the ball can go and how fast it goes off the bat. The farther and faster the ball goes the more likely a player is to progress across the three bases and get to the homebase. The homebase is the base after the three bases. \n",
    "\n",
    "How does weather at MLB baseball games affect total runs? Total runs is the variable of interest. I combined per game away team runs with home team runs as I am not concerned with which team was affected by weather just that they were."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Outcome"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Was able to fit the data data with an 80% training and 20% test set with 98.65% accuracy with grid search. 86.725% with a regression probability test, Random Forrest. Root mean squared error of 11.647. \n",
    "RMSE/MAE=0 \n",
    "\n",
    "MAE: -62.452 (3.265)=>RMSE/MAE=0=>-0.18650265804137578\n",
    "The RMSE/ MAE is good as it is close to zero. \n",
    "The root mean squared is higher than expected. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Variables"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "attendance, away_team, away_team_errors, away_team_hits, away_team_runs, date, field_type, game_type, home_team, home_team_errors, home_team_hits, home_team_runs, start_time, venue,day_of_week,temperature, wind_speed, wind_direction, sky, total_runs,game_hours_dec, season, home_team_win, home_team_loss, home_team_outcome"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:33:42.952424Z",
     "iopub.status.busy": "2022-05-10T20:33:42.952094Z",
     "iopub.status.idle": "2022-05-10T20:33:42.987749Z",
     "shell.execute_reply": "2022-05-10T20:33:42.986942Z",
     "shell.execute_reply.started": "2022-05-10T20:33:42.952389Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/andrewbradbury/opt/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3444: FutureWarning: The error_bad_lines argument has been deprecated and will be removed in a future version.\n",
      "\n",
      "\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    }
   ],
   "source": [
    "url = pd.read_csv('/Users/andrewbradbury/Documents/Python/baseball_reference_2016_clean.csv')\n",
    "import pandas as pd\n",
    "url = '/Users/andrewbradbury/Documents/Python/baseball_reference_2016_clean.csv'\n",
    "df = pd.read_csv(url, error_bad_lines=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Check for Blanks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:34:47.555973Z",
     "iopub.status.busy": "2022-05-10T20:34:47.555695Z",
     "iopub.status.idle": "2022-05-10T20:34:47.575237Z",
     "shell.execute_reply": "2022-05-10T20:34:47.574451Z",
     "shell.execute_reply.started": "2022-05-10T20:34:47.555944Z"
    },
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0           0.000000\n",
       "attendance           0.001218\n",
       "away_team            0.000000\n",
       "away_team_errors     0.000000\n",
       "away_team_hits       0.000000\n",
       "away_team_runs       0.000000\n",
       "date                 0.000000\n",
       "field_type           0.000000\n",
       "game_type            0.000000\n",
       "home_team            0.000000\n",
       "home_team_errors     0.000000\n",
       "home_team_hits       0.000000\n",
       "home_team_runs       0.000000\n",
       "start_time           0.000000\n",
       "venue                0.000000\n",
       "day_of_week          0.000000\n",
       "temperature          0.000000\n",
       "wind_speed           0.000000\n",
       "wind_direction       0.000000\n",
       "sky                  0.000000\n",
       "total_runs           0.000000\n",
       "game_hours_dec       0.000000\n",
       "season               0.000000\n",
       "home_team_win        0.000000\n",
       "home_team_loss       0.000000\n",
       "home_team_outcome    0.000000\n",
       "dtype: float64"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Check for Blanks\n",
    "df.isnull().sum()/len(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[0, 1, 2, 3, 4]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_top = df.head()\n",
    "   \n",
    "# list(data_top) or\n",
    "list(data_top.index)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Eliminate Blanks "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:35:29.029740Z",
     "iopub.status.busy": "2022-05-10T20:35:29.029449Z",
     "iopub.status.idle": "2022-05-10T20:35:29.038336Z",
     "shell.execute_reply": "2022-05-10T20:35:29.037079Z",
     "shell.execute_reply.started": "2022-05-10T20:35:29.029704Z"
    }
   },
   "outputs": [],
   "source": [
    "#Eliminate Blanks\n",
    "df[\"attendance\"] = df.attendance.fillna(-99)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:35:40.458133Z",
     "iopub.status.busy": "2022-05-10T20:35:40.457847Z",
     "iopub.status.idle": "2022-05-10T20:35:40.474120Z",
     "shell.execute_reply": "2022-05-10T20:35:40.473503Z",
     "shell.execute_reply.started": "2022-05-10T20:35:40.458100Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0           0.0\n",
       "attendance           0.0\n",
       "away_team            0.0\n",
       "away_team_errors     0.0\n",
       "away_team_hits       0.0\n",
       "away_team_runs       0.0\n",
       "date                 0.0\n",
       "field_type           0.0\n",
       "game_type            0.0\n",
       "home_team            0.0\n",
       "home_team_errors     0.0\n",
       "home_team_hits       0.0\n",
       "home_team_runs       0.0\n",
       "start_time           0.0\n",
       "venue                0.0\n",
       "day_of_week          0.0\n",
       "temperature          0.0\n",
       "wind_speed           0.0\n",
       "wind_direction       0.0\n",
       "sky                  0.0\n",
       "total_runs           0.0\n",
       "game_hours_dec       0.0\n",
       "season               0.0\n",
       "home_team_win        0.0\n",
       "home_team_loss       0.0\n",
       "home_team_outcome    0.0\n",
       "dtype: float64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Double Check for Blanks\n",
    "df.isnull().sum()/len(df)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Check Data Type "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2463, 26)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Unnamed: 0             int64\n",
       "attendance           float64\n",
       "away_team             object\n",
       "away_team_errors       int64\n",
       "away_team_hits         int64\n",
       "away_team_runs         int64\n",
       "date                  object\n",
       "field_type            object\n",
       "game_type             object\n",
       "home_team             object\n",
       "home_team_errors       int64\n",
       "home_team_hits         int64\n",
       "home_team_runs         int64\n",
       "start_time            object\n",
       "venue                 object\n",
       "day_of_week           object\n",
       "temperature          float64\n",
       "wind_speed           float64\n",
       "wind_direction        object\n",
       "sky                   object\n",
       "total_runs             int64\n",
       "game_hours_dec       float64\n",
       "season                object\n",
       "home_team_win          int64\n",
       "home_team_loss         int64\n",
       "home_team_outcome     object\n",
       "dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(df.shape)\n",
    "# Check Data Type\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Convert Objects to Dummies "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pd.get_dummies(df, columns=['home_team'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['away_team'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['date'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['field_type'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['game_type'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['start_time'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['venue'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['day_of_week'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['wind_direction'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['sky'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['season'], drop_first=True)\n",
    "df = pd.get_dummies(df, columns=['home_team_outcome'], drop_first=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2463, 535)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "attendance               float64\n",
       "away_team_errors           int64\n",
       "away_team_hits             int64\n",
       "away_team_runs             int64\n",
       "                          ...   \n",
       "sky_Rain                   uint8\n",
       "sky_Sunny                  uint8\n",
       "sky_Unknown                uint8\n",
       "season_regular season      uint8\n",
       "home_team_outcome_Win      uint8\n",
       "Length: 535, dtype: object"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check for change for drops\n",
    "print(df.shape)\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:36:05.363650Z",
     "iopub.status.busy": "2022-05-10T20:36:05.363302Z",
     "iopub.status.idle": "2022-05-10T20:36:05.413200Z",
     "shell.execute_reply": "2022-05-10T20:36:05.412297Z",
     "shell.execute_reply.started": "2022-05-10T20:36:05.363610Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>40030.0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>74.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>21621.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>55.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12622.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>48.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>18531.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>65.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>18572.0</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>77.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2458</th>\n",
       "      <td>2458</td>\n",
       "      <td>31042.0</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2459</th>\n",
       "      <td>2459</td>\n",
       "      <td>39500.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>39.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2460</th>\n",
       "      <td>2460</td>\n",
       "      <td>20098.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>66.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2461</th>\n",
       "      <td>2461</td>\n",
       "      <td>17883.0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>3</td>\n",
       "      <td>71.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2462</th>\n",
       "      <td>2462</td>\n",
       "      <td>10298.0</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>60.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2463 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "0              0     40030.0                 1               7   \n",
       "1              1     21621.0                 0               5   \n",
       "2              2     12622.0                 0               5   \n",
       "3              3     18531.0                 0               8   \n",
       "4              4     18572.0                 1               8   \n",
       "...          ...         ...               ...             ...   \n",
       "2458        2458     31042.0                 2               7   \n",
       "2459        2459     39500.0                 0               5   \n",
       "2460        2460     20098.0                 0               6   \n",
       "2461        2461     17883.0                 0              13   \n",
       "2462        2462     10298.0                 1              10   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "0                  3                 0               9               4   \n",
       "1                  2                 0               8               3   \n",
       "2                  2                 0               9               4   \n",
       "3                  3                 1               8               1   \n",
       "4                  4                 0               8               3   \n",
       "...              ...               ...             ...             ...   \n",
       "2458               5                 1               7               3   \n",
       "2459               1                 1               9               4   \n",
       "2460               3                 2               9               4   \n",
       "2461               7                 1              10               3   \n",
       "2462               6                 0               9               7   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "0            74.0        14.0  ...                                  0   \n",
       "1            55.0        24.0  ...                                  0   \n",
       "2            48.0         7.0  ...                                  0   \n",
       "3            65.0        10.0  ...                                  0   \n",
       "4            77.0         0.0  ...                                  0   \n",
       "...           ...         ...  ...                                ...   \n",
       "2458         72.0         0.0  ...                                  0   \n",
       "2459         39.0        14.0  ...                                  0   \n",
       "2460         66.0         0.0  ...                                  0   \n",
       "2461         71.0         0.0  ...                                  0   \n",
       "2462         60.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "0               0            0          0             0         0          1   \n",
       "1               0            0          0             1         0          0   \n",
       "2               0            0          0             0         0          0   \n",
       "3               0            0          0             0         0          0   \n",
       "4               0            1          0             0         0          0   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "2458            0            1          0             0         0          0   \n",
       "2459            0            0          0             0         0          0   \n",
       "2460            0            1          0             0         0          0   \n",
       "2461            0            1          0             0         0          0   \n",
       "2462            0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "0               0                      1                      1  \n",
       "1               0                      1                      1  \n",
       "2               1                      1                      1  \n",
       "3               0                      1                      0  \n",
       "4               0                      1                      0  \n",
       "...           ...                    ...                    ...  \n",
       "2458            0                      1                      0  \n",
       "2459            1                      1                      1  \n",
       "2460            0                      1                      1  \n",
       "2461            0                      1                      0  \n",
       "2462            1                      1                      1  \n",
       "\n",
       "[2463 rows x 535 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Combined Per game away team runs w/ home team runs to get total runs per game "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:38:47.172844Z",
     "iopub.status.busy": "2022-05-10T20:38:47.172538Z",
     "iopub.status.idle": "2022-05-10T20:38:47.178587Z",
     "shell.execute_reply": "2022-05-10T20:38:47.177766Z",
     "shell.execute_reply.started": "2022-05-10T20:38:47.172814Z"
    }
   },
   "outputs": [],
   "source": [
    "# Combine Variables (Contruct New Features)\n",
    "df['total_runs'] = df['away_team_runs'] + df['home_team_runs']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-10T20:39:52.913078Z",
     "iopub.status.busy": "2022-05-10T20:39:52.912302Z",
     "iopub.status.idle": "2022-05-10T20:39:52.953277Z",
     "shell.execute_reply": "2022-05-10T20:39:52.952437Z",
     "shell.execute_reply.started": "2022-05-10T20:39:52.913037Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>40030.0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>74.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>21621.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>55.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12622.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>48.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>18531.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>1</td>\n",
       "      <td>65.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>18572.0</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>77.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2458</th>\n",
       "      <td>2458</td>\n",
       "      <td>31042.0</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2459</th>\n",
       "      <td>2459</td>\n",
       "      <td>39500.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>39.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2460</th>\n",
       "      <td>2460</td>\n",
       "      <td>20098.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>66.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2461</th>\n",
       "      <td>2461</td>\n",
       "      <td>17883.0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>3</td>\n",
       "      <td>71.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2462</th>\n",
       "      <td>2462</td>\n",
       "      <td>10298.0</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>60.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2463 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "0              0     40030.0                 1               7   \n",
       "1              1     21621.0                 0               5   \n",
       "2              2     12622.0                 0               5   \n",
       "3              3     18531.0                 0               8   \n",
       "4              4     18572.0                 1               8   \n",
       "...          ...         ...               ...             ...   \n",
       "2458        2458     31042.0                 2               7   \n",
       "2459        2459     39500.0                 0               5   \n",
       "2460        2460     20098.0                 0               6   \n",
       "2461        2461     17883.0                 0              13   \n",
       "2462        2462     10298.0                 1              10   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "0                  3                 0               9               4   \n",
       "1                  2                 0               8               3   \n",
       "2                  2                 0               9               4   \n",
       "3                  3                 1               8               1   \n",
       "4                  4                 0               8               3   \n",
       "...              ...               ...             ...             ...   \n",
       "2458               5                 1               7               3   \n",
       "2459               1                 1               9               4   \n",
       "2460               3                 2               9               4   \n",
       "2461               7                 1              10               3   \n",
       "2462               6                 0               9               7   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "0            74.0        14.0  ...                                  0   \n",
       "1            55.0        24.0  ...                                  0   \n",
       "2            48.0         7.0  ...                                  0   \n",
       "3            65.0        10.0  ...                                  0   \n",
       "4            77.0         0.0  ...                                  0   \n",
       "...           ...         ...  ...                                ...   \n",
       "2458         72.0         0.0  ...                                  0   \n",
       "2459         39.0        14.0  ...                                  0   \n",
       "2460         66.0         0.0  ...                                  0   \n",
       "2461         71.0         0.0  ...                                  0   \n",
       "2462         60.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "0               0            0          0             0         0          1   \n",
       "1               0            0          0             1         0          0   \n",
       "2               0            0          0             0         0          0   \n",
       "3               0            0          0             0         0          0   \n",
       "4               0            1          0             0         0          0   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "2458            0            1          0             0         0          0   \n",
       "2459            0            0          0             0         0          0   \n",
       "2460            0            1          0             0         0          0   \n",
       "2461            0            1          0             0         0          0   \n",
       "2462            0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "0               0                      1                      1  \n",
       "1               0                      1                      1  \n",
       "2               1                      1                      1  \n",
       "3               0                      1                      0  \n",
       "4               0                      1                      0  \n",
       "...           ...                    ...                    ...  \n",
       "2458            0                      1                      0  \n",
       "2459            1                      1                      1  \n",
       "2460            0                      1                      1  \n",
       "2461            0                      1                      0  \n",
       "2462            1                      1                      1  \n",
       "\n",
       "[2463 rows x 535 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check combine variables\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Places NA/NaN in locations having no value in the previous index. A new object is produced unless the new index is equivalent to the current one and copy=False.\n",
    "df = df.reindex(labels=df.columns,axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Model selection splitting into train and test set w/ 80% test and 20% train\n",
    " "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "import numpy as np\n",
    "train, test = train_test_split(df, test_size=0.2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "train = train[test.columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0               0.0\n",
       "attendance               0.0\n",
       "away_team_errors         0.0\n",
       "away_team_hits           0.0\n",
       "away_team_runs           0.0\n",
       "                        ... \n",
       "sky_Rain                 0.0\n",
       "sky_Sunny                0.0\n",
       "sky_Unknown              0.0\n",
       "season_regular season    0.0\n",
       "home_team_outcome_Win    0.0\n",
       "Length: 535, dtype: float64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.isnull().sum()/len(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "df=df.drop(labels=3,axis=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2462, 535)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "attendance               float64\n",
       "away_team_errors           int64\n",
       "away_team_hits             int64\n",
       "away_team_runs             int64\n",
       "                          ...   \n",
       "sky_Rain                   uint8\n",
       "sky_Sunny                  uint8\n",
       "sky_Unknown                uint8\n",
       "season_regular season      uint8\n",
       "home_team_outcome_Win      uint8\n",
       "Length: 535, dtype: object"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(df.shape)\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2462, 535)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "attendance               float64\n",
       "away_team_errors           int64\n",
       "away_team_hits             int64\n",
       "away_team_runs             int64\n",
       "                          ...   \n",
       "sky_Rain                   uint8\n",
       "sky_Sunny                  uint8\n",
       "sky_Unknown                uint8\n",
       "season_regular season      uint8\n",
       "home_team_outcome_Win      uint8\n",
       "Length: 535, dtype: object"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(df.shape)\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.loc[:, df.dtypes == 'float64'] = df.loc[:, df.dtypes == 'float64'].astype('float32')\n",
    "df.loc[:, df.dtypes == 'int64'] = df.loc[:, df.dtypes == 'int64'].astype('int32')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "for column in df.columns:\n",
    "   if df[column].dtype == \"bool\":\n",
    "        df[column] = df[column].astype(\"int\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "dummy_variables = [column for column in df.columns if df[column].dtype==\"object\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "df1 = pd.get_dummies(df, columns = dummy_variables, drop_first = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1421</th>\n",
       "      <td>1421</td>\n",
       "      <td>20473.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>7</td>\n",
       "      <td>80.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1093</th>\n",
       "      <td>1093</td>\n",
       "      <td>11149.0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1311</th>\n",
       "      <td>1311</td>\n",
       "      <td>39620.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>79.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>63</td>\n",
       "      <td>34279.0</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>8</td>\n",
       "      <td>49.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>1666</td>\n",
       "      <td>41583.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>64.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>529</td>\n",
       "      <td>12139.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>906</th>\n",
       "      <td>906</td>\n",
       "      <td>48113.0</td>\n",
       "      <td>0</td>\n",
       "      <td>15</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>76.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1981</th>\n",
       "      <td>1981</td>\n",
       "      <td>27652.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>57.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>633</th>\n",
       "      <td>633</td>\n",
       "      <td>14671.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>78.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>740</th>\n",
       "      <td>740</td>\n",
       "      <td>26637.0</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>76.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>493 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "1421        1421     20473.0                 0               7   \n",
       "1093        1093     11149.0                 3               2   \n",
       "1311        1311     39620.0                 1               6   \n",
       "63            63     34279.0                 2               9   \n",
       "1666        1666     41583.0                 1               6   \n",
       "...          ...         ...               ...             ...   \n",
       "529          529     12139.0                 0               8   \n",
       "906          906     48113.0                 0              15   \n",
       "1981        1981     27652.0                 0               7   \n",
       "633          633     14671.0                 0               6   \n",
       "740          740     26637.0                 1              14   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "1421               2                 0              11               7   \n",
       "1093               0                 0              14              12   \n",
       "1311               0                 0               2               1   \n",
       "63                 7                 0              14               8   \n",
       "1666               1                 0               5               2   \n",
       "...              ...               ...             ...             ...   \n",
       "529                2                 0               3               1   \n",
       "906                9                 2               5               2   \n",
       "1981               2                 0              10               7   \n",
       "633                0                 1               7               3   \n",
       "740                7                 0               9               4   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "1421         80.0         5.0  ...                                  0   \n",
       "1093         72.0         0.0  ...                                  0   \n",
       "1311         79.0         6.0  ...                                  1   \n",
       "63           49.0         9.0  ...                                  0   \n",
       "1666         64.0        13.0  ...                                  1   \n",
       "...           ...         ...  ...                                ...   \n",
       "529          61.0         9.0  ...                                  1   \n",
       "906          76.0         5.0  ...                                  0   \n",
       "1981         57.0         1.0  ...                                  0   \n",
       "633          78.0         0.0  ...                                  0   \n",
       "740          76.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "1421            0            0          0             0         0          0   \n",
       "1093            0            1          0             0         0          0   \n",
       "1311            0            0          0             0         0          1   \n",
       "63              1            0          0             0         0          0   \n",
       "1666            0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "529             0            0          0             0         0          0   \n",
       "906             0            0          0             0         0          1   \n",
       "1981            0            0          0             0         0          0   \n",
       "633             0            0          0             0         0          1   \n",
       "740             0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "1421            0                      1                      1  \n",
       "1093            0                      1                      1  \n",
       "1311            0                      1                      1  \n",
       "63              0                      1                      1  \n",
       "1666            0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "529             0                      1                      0  \n",
       "906             0                      1                      0  \n",
       "1981            0                      1                      1  \n",
       "633             0                      1                      1  \n",
       "740             0                      1                      0  \n",
       "\n",
       "[493 rows x 535 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1421</th>\n",
       "      <td>1421</td>\n",
       "      <td>20473.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>7</td>\n",
       "      <td>80.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1093</th>\n",
       "      <td>1093</td>\n",
       "      <td>11149.0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1311</th>\n",
       "      <td>1311</td>\n",
       "      <td>39620.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>79.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>63</td>\n",
       "      <td>34279.0</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>8</td>\n",
       "      <td>49.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>1666</td>\n",
       "      <td>41583.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>64.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>529</td>\n",
       "      <td>12139.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>906</th>\n",
       "      <td>906</td>\n",
       "      <td>48113.0</td>\n",
       "      <td>0</td>\n",
       "      <td>15</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>76.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1981</th>\n",
       "      <td>1981</td>\n",
       "      <td>27652.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>57.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>633</th>\n",
       "      <td>633</td>\n",
       "      <td>14671.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>78.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>740</th>\n",
       "      <td>740</td>\n",
       "      <td>26637.0</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>76.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>493 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "1421        1421     20473.0                 0               7   \n",
       "1093        1093     11149.0                 3               2   \n",
       "1311        1311     39620.0                 1               6   \n",
       "63            63     34279.0                 2               9   \n",
       "1666        1666     41583.0                 1               6   \n",
       "...          ...         ...               ...             ...   \n",
       "529          529     12139.0                 0               8   \n",
       "906          906     48113.0                 0              15   \n",
       "1981        1981     27652.0                 0               7   \n",
       "633          633     14671.0                 0               6   \n",
       "740          740     26637.0                 1              14   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "1421               2                 0              11               7   \n",
       "1093               0                 0              14              12   \n",
       "1311               0                 0               2               1   \n",
       "63                 7                 0              14               8   \n",
       "1666               1                 0               5               2   \n",
       "...              ...               ...             ...             ...   \n",
       "529                2                 0               3               1   \n",
       "906                9                 2               5               2   \n",
       "1981               2                 0              10               7   \n",
       "633                0                 1               7               3   \n",
       "740                7                 0               9               4   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "1421         80.0         5.0  ...                                  0   \n",
       "1093         72.0         0.0  ...                                  0   \n",
       "1311         79.0         6.0  ...                                  1   \n",
       "63           49.0         9.0  ...                                  0   \n",
       "1666         64.0        13.0  ...                                  1   \n",
       "...           ...         ...  ...                                ...   \n",
       "529          61.0         9.0  ...                                  1   \n",
       "906          76.0         5.0  ...                                  0   \n",
       "1981         57.0         1.0  ...                                  0   \n",
       "633          78.0         0.0  ...                                  0   \n",
       "740          76.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "1421            0            0          0             0         0          0   \n",
       "1093            0            1          0             0         0          0   \n",
       "1311            0            0          0             0         0          1   \n",
       "63              1            0          0             0         0          0   \n",
       "1666            0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "529             0            0          0             0         0          0   \n",
       "906             0            0          0             0         0          1   \n",
       "1981            0            0          0             0         0          0   \n",
       "633             0            0          0             0         0          1   \n",
       "740             0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "1421            0                      1                      1  \n",
       "1093            0                      1                      1  \n",
       "1311            0                      1                      1  \n",
       "63              0                      1                      1  \n",
       "1666            0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "529             0                      1                      0  \n",
       "906             0                      1                      0  \n",
       "1981            0                      1                      1  \n",
       "633             0                      1                      1  \n",
       "740             0                      1                      0  \n",
       "\n",
       "[493 rows x 535 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2449</th>\n",
       "      <td>2449</td>\n",
       "      <td>15116.0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2261</th>\n",
       "      <td>2261</td>\n",
       "      <td>23439.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>66.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>620</th>\n",
       "      <td>620</td>\n",
       "      <td>38041.0</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>80.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2413</th>\n",
       "      <td>2413</td>\n",
       "      <td>33471.0</td>\n",
       "      <td>3</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>60.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>957</th>\n",
       "      <td>957</td>\n",
       "      <td>37546.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>84.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>636</th>\n",
       "      <td>636</td>\n",
       "      <td>18271.0</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "      <td>12</td>\n",
       "      <td>79.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>605</th>\n",
       "      <td>605</td>\n",
       "      <td>37973.0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1380</th>\n",
       "      <td>1380</td>\n",
       "      <td>23848.0</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>83.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>622</th>\n",
       "      <td>622</td>\n",
       "      <td>20897.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "      <td>11</td>\n",
       "      <td>93.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2046</th>\n",
       "      <td>2046</td>\n",
       "      <td>37828.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1970 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "2449        2449     15116.0                 1               7   \n",
       "2261        2261     23439.0                 0              10   \n",
       "620          620     38041.0                 1               9   \n",
       "2413        2413     33471.0                 3              14   \n",
       "957          957     37546.0                 0              10   \n",
       "...          ...         ...               ...             ...   \n",
       "636          636     18271.0                 1              17   \n",
       "605          605     37973.0                 1               5   \n",
       "1380        1380     23848.0                 0              11   \n",
       "622          622     20897.0                 0               8   \n",
       "2046        2046     37828.0                 1               3   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "2449               5                 0               8               3   \n",
       "2261               5                 0               6               2   \n",
       "620                6                 0               9               3   \n",
       "2413              12                 3               4               2   \n",
       "957                6                 2               8               7   \n",
       "...              ...               ...             ...             ...   \n",
       "636                7                 0              17              12   \n",
       "605                1                 0               4               0   \n",
       "1380               5                 0               7               4   \n",
       "622                4                 0              17              11   \n",
       "2046               1                 0               4               0   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "2449         72.0         0.0  ...                                  0   \n",
       "2261         66.0         0.0  ...                                  0   \n",
       "620          80.0        16.0  ...                                  1   \n",
       "2413         60.0        15.0  ...                                  0   \n",
       "957          84.0         7.0  ...                                  0   \n",
       "...           ...         ...  ...                                ...   \n",
       "636          79.0        13.0  ...                                  0   \n",
       "605          82.0        14.0  ...                                  1   \n",
       "1380         83.0         3.0  ...                                  0   \n",
       "622          93.0        11.0  ...                                  0   \n",
       "2046         52.0         4.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "2449            0            1          0             0         0          0   \n",
       "2261            0            1          0             0         0          0   \n",
       "620             0            0          0             0         0          1   \n",
       "2413            0            0          0             0         0          1   \n",
       "957             0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "636             0            0          0             0         0          0   \n",
       "605             0            0          0             0         0          0   \n",
       "1380            0            0          0             0         0          1   \n",
       "622             0            0          0             0         0          0   \n",
       "2046            0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "2449            0                      1                      0  \n",
       "2261            0                      1                      0  \n",
       "620             0                      1                      0  \n",
       "2413            0                      1                      0  \n",
       "957             0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "636             1                      1                      1  \n",
       "605             1                      1                      0  \n",
       "1380            0                      1                      0  \n",
       "622             0                      1                      1  \n",
       "2046            1                      1                      0  \n",
       "\n",
       "[1970 rows x 535 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Setting X = training set w/o total runs\n",
    "X = train.drop([\"total_runs\"], axis=1)\n",
    "# Setting y = training set w/ runs\n",
    "y = train[\"total_runs\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1970, 534) (1970,)\n"
     ]
    }
   ],
   "source": [
    "print(X.shape, y.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "# Create the parameter grid \n",
    "param_grid = {\n",
    "    'bootstrap': [True],\n",
    "    'max_features': [2, 3],\n",
    "    'n_estimators': [200, 300, 1000]\n",
    "}\n",
    "# Create a based model\n",
    "rf =  RandomForestRegressor()\n",
    "# Instantiate the grid search model\n",
    "grid_search = GridSearchCV(estimator = rf, param_grid = param_grid, \n",
    "                          cv = 3, n_jobs = -1, verbose = 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1970, 534)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "Unnamed: 0                 int64\n",
       "attendance               float64\n",
       "away_team_errors           int64\n",
       "away_team_hits             int64\n",
       "away_team_runs             int64\n",
       "                          ...   \n",
       "sky_Rain                   uint8\n",
       "sky_Sunny                  uint8\n",
       "sky_Unknown                uint8\n",
       "season_regular season      uint8\n",
       "home_team_outcome_Win      uint8\n",
       "Length: 534, dtype: object"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(X.shape)\n",
    "X.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitting 3 folds for each of 6 candidates, totalling 18 fits\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "GridSearchCV(cv=3, estimator=RandomForestRegressor(), n_jobs=-1,\n",
       "             param_grid={'bootstrap': [True], 'max_features': [2, 3],\n",
       "                         'n_estimators': [200, 300, 1000]},\n",
       "             verbose=2)"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grid_search.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "GridSearchCV(cv=3, estimator=RandomForestRegressor(), n_jobs=-1,\n",
       "             param_grid={'bootstrap': [True], 'max_features': [2, 3],\n",
       "                         'n_estimators': [200, 300, 1000]},\n",
       "             verbose=2)"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "GridSearchCV(cv=3, estimator=RandomForestRegressor(), n_jobs=-1,\n",
    "             param_grid={'bootstrap': [True], 'max_features': [2, 3],\n",
    "                         'n_estimators': [200, 300, 1000]},\n",
    "             verbose=2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(max_features=3, n_estimators=200)"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "grid_search.best_estimator_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "rf = RandomForestRegressor(max_features=3, n_estimators=300)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.datasets import make_regression\n",
    "X, y = make_regression(n_features=4, n_informative=2, random_state=0, shuffle=False)\n",
    "regr = RandomForestRegressor(max_depth=2, random_state=0)\n",
    "regr.fit(X, y)\n",
    "regr.predict([[0, 0, 0, 0]])\n",
    "from sklearn.svm import SVR\n",
    "from sklearn.svm import SVC\n",
    "from sklearn import svm\n",
    "import sklearn\n",
    "svc = sklearn.svm.SVC()\n",
    "svc = SVC()\n",
    "svc = svm.SVC()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(max_features=3, n_estimators=300)"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check features and estimators\n",
    "rf.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "# run test with out variable of interest\n",
    "test = test.drop([\"total_runs\"], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>40030.0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>74.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>21621.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>55.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>12622.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>48.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>18572.0</td>\n",
       "      <td>1</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>77.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>5</td>\n",
       "      <td>28386.0</td>\n",
       "      <td>1</td>\n",
       "      <td>11</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>81.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2458</th>\n",
       "      <td>2458</td>\n",
       "      <td>31042.0</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2459</th>\n",
       "      <td>2459</td>\n",
       "      <td>39500.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>39.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2460</th>\n",
       "      <td>2460</td>\n",
       "      <td>20098.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>66.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2461</th>\n",
       "      <td>2461</td>\n",
       "      <td>17883.0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>3</td>\n",
       "      <td>71.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2462</th>\n",
       "      <td>2462</td>\n",
       "      <td>10298.0</td>\n",
       "      <td>1</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>60.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2462 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "0              0     40030.0                 1               7   \n",
       "1              1     21621.0                 0               5   \n",
       "2              2     12622.0                 0               5   \n",
       "4              4     18572.0                 1               8   \n",
       "5              5     28386.0                 1              11   \n",
       "...          ...         ...               ...             ...   \n",
       "2458        2458     31042.0                 2               7   \n",
       "2459        2459     39500.0                 0               5   \n",
       "2460        2460     20098.0                 0               6   \n",
       "2461        2461     17883.0                 0              13   \n",
       "2462        2462     10298.0                 1              10   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "0                  3                 0               9               4   \n",
       "1                  2                 0               8               3   \n",
       "2                  2                 0               9               4   \n",
       "4                  4                 0               8               3   \n",
       "5                 10                 1               7               2   \n",
       "...              ...               ...             ...             ...   \n",
       "2458               5                 1               7               3   \n",
       "2459               1                 1               9               4   \n",
       "2460               3                 2               9               4   \n",
       "2461               7                 1              10               3   \n",
       "2462               6                 0               9               7   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "0            74.0        14.0  ...                                  0   \n",
       "1            55.0        24.0  ...                                  0   \n",
       "2            48.0         7.0  ...                                  0   \n",
       "4            77.0         0.0  ...                                  0   \n",
       "5            81.0        12.0  ...                                  0   \n",
       "...           ...         ...  ...                                ...   \n",
       "2458         72.0         0.0  ...                                  0   \n",
       "2459         39.0        14.0  ...                                  0   \n",
       "2460         66.0         0.0  ...                                  0   \n",
       "2461         71.0         0.0  ...                                  0   \n",
       "2462         60.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "0               0            0          0             0         0          1   \n",
       "1               0            0          0             1         0          0   \n",
       "2               0            0          0             0         0          0   \n",
       "4               0            1          0             0         0          0   \n",
       "5               0            0          0             0         0          0   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "2458            0            1          0             0         0          0   \n",
       "2459            0            0          0             0         0          0   \n",
       "2460            0            1          0             0         0          0   \n",
       "2461            0            1          0             0         0          0   \n",
       "2462            0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "0               0                      1                      1  \n",
       "1               0                      1                      1  \n",
       "2               1                      1                      1  \n",
       "4               0                      1                      0  \n",
       "5               0                      1                      0  \n",
       "...           ...                    ...                    ...  \n",
       "2458            0                      1                      0  \n",
       "2459            1                      1                      1  \n",
       "2460            0                      1                      1  \n",
       "2461            0                      1                      0  \n",
       "2462            1                      1                      1  \n",
       "\n",
       "[2462 rows x 535 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1421</th>\n",
       "      <td>1421</td>\n",
       "      <td>20473.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>7</td>\n",
       "      <td>80.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1093</th>\n",
       "      <td>1093</td>\n",
       "      <td>11149.0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1311</th>\n",
       "      <td>1311</td>\n",
       "      <td>39620.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>79.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>63</td>\n",
       "      <td>34279.0</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>8</td>\n",
       "      <td>49.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>1666</td>\n",
       "      <td>41583.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>64.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>529</td>\n",
       "      <td>12139.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>906</th>\n",
       "      <td>906</td>\n",
       "      <td>48113.0</td>\n",
       "      <td>0</td>\n",
       "      <td>15</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>76.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1981</th>\n",
       "      <td>1981</td>\n",
       "      <td>27652.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>57.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>633</th>\n",
       "      <td>633</td>\n",
       "      <td>14671.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>78.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>740</th>\n",
       "      <td>740</td>\n",
       "      <td>26637.0</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>76.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>493 rows × 534 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "1421        1421     20473.0                 0               7   \n",
       "1093        1093     11149.0                 3               2   \n",
       "1311        1311     39620.0                 1               6   \n",
       "63            63     34279.0                 2               9   \n",
       "1666        1666     41583.0                 1               6   \n",
       "...          ...         ...               ...             ...   \n",
       "529          529     12139.0                 0               8   \n",
       "906          906     48113.0                 0              15   \n",
       "1981        1981     27652.0                 0               7   \n",
       "633          633     14671.0                 0               6   \n",
       "740          740     26637.0                 1              14   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "1421               2                 0              11               7   \n",
       "1093               0                 0              14              12   \n",
       "1311               0                 0               2               1   \n",
       "63                 7                 0              14               8   \n",
       "1666               1                 0               5               2   \n",
       "...              ...               ...             ...             ...   \n",
       "529                2                 0               3               1   \n",
       "906                9                 2               5               2   \n",
       "1981               2                 0              10               7   \n",
       "633                0                 1               7               3   \n",
       "740                7                 0               9               4   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "1421         80.0         5.0  ...                                  0   \n",
       "1093         72.0         0.0  ...                                  0   \n",
       "1311         79.0         6.0  ...                                  1   \n",
       "63           49.0         9.0  ...                                  0   \n",
       "1666         64.0        13.0  ...                                  1   \n",
       "...           ...         ...  ...                                ...   \n",
       "529          61.0         9.0  ...                                  1   \n",
       "906          76.0         5.0  ...                                  0   \n",
       "1981         57.0         1.0  ...                                  0   \n",
       "633          78.0         0.0  ...                                  0   \n",
       "740          76.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "1421            0            0          0             0         0          0   \n",
       "1093            0            1          0             0         0          0   \n",
       "1311            0            0          0             0         0          1   \n",
       "63              1            0          0             0         0          0   \n",
       "1666            0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "529             0            0          0             0         0          0   \n",
       "906             0            0          0             0         0          1   \n",
       "1981            0            0          0             0         0          0   \n",
       "633             0            0          0             0         0          1   \n",
       "740             0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "1421            0                      1                      1  \n",
       "1093            0                      1                      1  \n",
       "1311            0                      1                      1  \n",
       "63              0                      1                      1  \n",
       "1666            0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "529             0                      1                      0  \n",
       "906             0                      1                      0  \n",
       "1981            0                      1                      1  \n",
       "633             0                      1                      1  \n",
       "740             0                      1                      0  \n",
       "\n",
       "[493 rows x 534 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[51.2580068]\n"
     ]
    }
   ],
   "source": [
    "#fits a number of classifying decision trees on various sub-samples of the dataset\n",
    "# uses averaging to improve the predictive accuracy and control over-fitting\n",
    "from sklearn.ensemble import RandomForestRegressor\n",
    "from sklearn.datasets import make_regression\n",
    "X, y = make_regression(n_samples=1000, n_features=4,\n",
    "                            n_informative=2,\n",
    "                        random_state=0, shuffle=False)\n",
    "regr = RandomForestRegressor(max_depth=2, random_state=0)\n",
    "regr.fit(X, y)\n",
    "RandomForestRegressor(...)\n",
    "print(regr.predict([[0, 0, 0, 0]]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor()"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestRegressor\n",
    "rf = RandomForestRegressor()\n",
    "rf.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Exhaustive search over specified parameter values for an estimator\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "# Create the parameter grid \n",
    "param_grid = {\n",
    "    'bootstrap': [True],\n",
    "    'max_features': [2, 3],\n",
    "    'n_estimators': [200, 300, 1000]\n",
    "}\n",
    "# Create a based model\n",
    "rf = RandomForestRegressor()\n",
    "# Instantiate the grid search model\n",
    "grid_search = GridSearchCV(estimator = rf, param_grid = param_grid, \n",
    "                          cv = 3, n_jobs = -1, verbose = 2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Fitting 3 folds for each of 6 candidates, totalling 18 fits\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "GridSearchCV(cv=3, estimator=RandomForestRegressor(), n_jobs=-1,\n",
       "             param_grid={'bootstrap': [True], 'max_features': [2, 3],\n",
       "                         'n_estimators': [200, 300, 1000]},\n",
       "             verbose=2)"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# fitting to X and y\n",
    "grid_search.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(max_features=3, n_estimators=200)"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# attribute and permits using predict directly on this GridSearchCV instance.\n",
    "grid_search.best_estimator_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [],
   "source": [
    "# meta estimator that fits a number of classifying decision trees on various sub-samples of the dataset \n",
    "# uses averaging to improve the predictive accuracy and control over-fitting\n",
    "rf = RandomForestRegressor(max_features=3, n_estimators=300)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RandomForestRegressor(max_depth=2, random_state=0)"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr.fit(X,y)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1421</th>\n",
       "      <td>1421</td>\n",
       "      <td>20473.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>7</td>\n",
       "      <td>80.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1093</th>\n",
       "      <td>1093</td>\n",
       "      <td>11149.0</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1311</th>\n",
       "      <td>1311</td>\n",
       "      <td>39620.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>79.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>63</td>\n",
       "      <td>34279.0</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>14</td>\n",
       "      <td>8</td>\n",
       "      <td>49.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>1666</td>\n",
       "      <td>41583.0</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>64.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>529</td>\n",
       "      <td>12139.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>61.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>906</th>\n",
       "      <td>906</td>\n",
       "      <td>48113.0</td>\n",
       "      <td>0</td>\n",
       "      <td>15</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>76.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1981</th>\n",
       "      <td>1981</td>\n",
       "      <td>27652.0</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>7</td>\n",
       "      <td>57.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>633</th>\n",
       "      <td>633</td>\n",
       "      <td>14671.0</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>3</td>\n",
       "      <td>78.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>740</th>\n",
       "      <td>740</td>\n",
       "      <td>26637.0</td>\n",
       "      <td>1</td>\n",
       "      <td>14</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>76.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>493 rows × 534 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "1421        1421     20473.0                 0               7   \n",
       "1093        1093     11149.0                 3               2   \n",
       "1311        1311     39620.0                 1               6   \n",
       "63            63     34279.0                 2               9   \n",
       "1666        1666     41583.0                 1               6   \n",
       "...          ...         ...               ...             ...   \n",
       "529          529     12139.0                 0               8   \n",
       "906          906     48113.0                 0              15   \n",
       "1981        1981     27652.0                 0               7   \n",
       "633          633     14671.0                 0               6   \n",
       "740          740     26637.0                 1              14   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "1421               2                 0              11               7   \n",
       "1093               0                 0              14              12   \n",
       "1311               0                 0               2               1   \n",
       "63                 7                 0              14               8   \n",
       "1666               1                 0               5               2   \n",
       "...              ...               ...             ...             ...   \n",
       "529                2                 0               3               1   \n",
       "906                9                 2               5               2   \n",
       "1981               2                 0              10               7   \n",
       "633                0                 1               7               3   \n",
       "740                7                 0               9               4   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "1421         80.0         5.0  ...                                  0   \n",
       "1093         72.0         0.0  ...                                  0   \n",
       "1311         79.0         6.0  ...                                  1   \n",
       "63           49.0         9.0  ...                                  0   \n",
       "1666         64.0        13.0  ...                                  1   \n",
       "...           ...         ...  ...                                ...   \n",
       "529          61.0         9.0  ...                                  1   \n",
       "906          76.0         5.0  ...                                  0   \n",
       "1981         57.0         1.0  ...                                  0   \n",
       "633          78.0         0.0  ...                                  0   \n",
       "740          76.0         7.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "1421            0            0          0             0         0          0   \n",
       "1093            0            1          0             0         0          0   \n",
       "1311            0            0          0             0         0          1   \n",
       "63              1            0          0             0         0          0   \n",
       "1666            0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "529             0            0          0             0         0          0   \n",
       "906             0            0          0             0         0          1   \n",
       "1981            0            0          0             0         0          0   \n",
       "633             0            0          0             0         0          1   \n",
       "740             0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "1421            0                      1                      1  \n",
       "1093            0                      1                      1  \n",
       "1311            0                      1                      1  \n",
       "63              0                      1                      1  \n",
       "1666            0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "529             0                      1                      0  \n",
       "906             0                      1                      0  \n",
       "1981            0                      1                      1  \n",
       "633             0                      1                      1  \n",
       "740             0                      1                      0  \n",
       "\n",
       "[493 rows x 534 columns]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "#  iloc property gets, or sets, the value(s) of the specified indexes. Specify both row and column with an index\n",
    "test= test.iloc[:, :4].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461, 86.72471461, 86.72471461,\n",
       "       86.72471461, 86.72471461, 86.72471461])"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr.predict(test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "86.72471461144009"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "regr.predict(test)[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>attendance</th>\n",
       "      <th>away_team_errors</th>\n",
       "      <th>away_team_hits</th>\n",
       "      <th>away_team_runs</th>\n",
       "      <th>home_team_errors</th>\n",
       "      <th>home_team_hits</th>\n",
       "      <th>home_team_runs</th>\n",
       "      <th>temperature</th>\n",
       "      <th>wind_speed</th>\n",
       "      <th>...</th>\n",
       "      <th>wind_direction_ out to Rightfield</th>\n",
       "      <th>sky_Drizzle</th>\n",
       "      <th>sky_In Dome</th>\n",
       "      <th>sky_Night</th>\n",
       "      <th>sky_Overcast</th>\n",
       "      <th>sky_Rain</th>\n",
       "      <th>sky_Sunny</th>\n",
       "      <th>sky_Unknown</th>\n",
       "      <th>season_regular season</th>\n",
       "      <th>home_team_outcome_Win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2449</th>\n",
       "      <td>2449</td>\n",
       "      <td>15116.0</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>72.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2261</th>\n",
       "      <td>2261</td>\n",
       "      <td>23439.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>66.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>620</th>\n",
       "      <td>620</td>\n",
       "      <td>38041.0</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>80.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2413</th>\n",
       "      <td>2413</td>\n",
       "      <td>33471.0</td>\n",
       "      <td>3</td>\n",
       "      <td>14</td>\n",
       "      <td>12</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>60.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>957</th>\n",
       "      <td>957</td>\n",
       "      <td>37546.0</td>\n",
       "      <td>0</td>\n",
       "      <td>10</td>\n",
       "      <td>6</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>7</td>\n",
       "      <td>84.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>636</th>\n",
       "      <td>636</td>\n",
       "      <td>18271.0</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "      <td>12</td>\n",
       "      <td>79.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>605</th>\n",
       "      <td>605</td>\n",
       "      <td>37973.0</td>\n",
       "      <td>1</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1380</th>\n",
       "      <td>1380</td>\n",
       "      <td>23848.0</td>\n",
       "      <td>0</td>\n",
       "      <td>11</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>83.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>622</th>\n",
       "      <td>622</td>\n",
       "      <td>20897.0</td>\n",
       "      <td>0</td>\n",
       "      <td>8</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>17</td>\n",
       "      <td>11</td>\n",
       "      <td>93.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2046</th>\n",
       "      <td>2046</td>\n",
       "      <td>37828.0</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1970 rows × 535 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Unnamed: 0  attendance  away_team_errors  away_team_hits  \\\n",
       "2449        2449     15116.0                 1               7   \n",
       "2261        2261     23439.0                 0              10   \n",
       "620          620     38041.0                 1               9   \n",
       "2413        2413     33471.0                 3              14   \n",
       "957          957     37546.0                 0              10   \n",
       "...          ...         ...               ...             ...   \n",
       "636          636     18271.0                 1              17   \n",
       "605          605     37973.0                 1               5   \n",
       "1380        1380     23848.0                 0              11   \n",
       "622          622     20897.0                 0               8   \n",
       "2046        2046     37828.0                 1               3   \n",
       "\n",
       "      away_team_runs  home_team_errors  home_team_hits  home_team_runs  \\\n",
       "2449               5                 0               8               3   \n",
       "2261               5                 0               6               2   \n",
       "620                6                 0               9               3   \n",
       "2413              12                 3               4               2   \n",
       "957                6                 2               8               7   \n",
       "...              ...               ...             ...             ...   \n",
       "636                7                 0              17              12   \n",
       "605                1                 0               4               0   \n",
       "1380               5                 0               7               4   \n",
       "622                4                 0              17              11   \n",
       "2046               1                 0               4               0   \n",
       "\n",
       "      temperature  wind_speed  ...  wind_direction_ out to Rightfield  \\\n",
       "2449         72.0         0.0  ...                                  0   \n",
       "2261         66.0         0.0  ...                                  0   \n",
       "620          80.0        16.0  ...                                  1   \n",
       "2413         60.0        15.0  ...                                  0   \n",
       "957          84.0         7.0  ...                                  0   \n",
       "...           ...         ...  ...                                ...   \n",
       "636          79.0        13.0  ...                                  0   \n",
       "605          82.0        14.0  ...                                  1   \n",
       "1380         83.0         3.0  ...                                  0   \n",
       "622          93.0        11.0  ...                                  0   \n",
       "2046         52.0         4.0  ...                                  0   \n",
       "\n",
       "      sky_Drizzle  sky_In Dome  sky_Night  sky_Overcast  sky_Rain  sky_Sunny  \\\n",
       "2449            0            1          0             0         0          0   \n",
       "2261            0            1          0             0         0          0   \n",
       "620             0            0          0             0         0          1   \n",
       "2413            0            0          0             0         0          1   \n",
       "957             0            0          0             0         0          1   \n",
       "...           ...          ...        ...           ...       ...        ...   \n",
       "636             0            0          0             0         0          0   \n",
       "605             0            0          0             0         0          0   \n",
       "1380            0            0          0             0         0          1   \n",
       "622             0            0          0             0         0          0   \n",
       "2046            0            0          0             0         0          0   \n",
       "\n",
       "      sky_Unknown  season_regular season  home_team_outcome_Win  \n",
       "2449            0                      1                      0  \n",
       "2261            0                      1                      0  \n",
       "620             0                      1                      0  \n",
       "2413            0                      1                      0  \n",
       "957             0                      1                      1  \n",
       "...           ...                    ...                    ...  \n",
       "636             1                      1                      1  \n",
       "605             1                      1                      0  \n",
       "1380            0                      1                      0  \n",
       "622             0                      1                      1  \n",
       "2046            1                      1                      0  \n",
       "\n",
       "[1970 rows x 535 columns]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [],
   "source": [
    "# split your dataset into subsets that minimize the potential for bias in your evaluation and validation process\n",
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state = 42, shuffle = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting xgboost==0.90\n",
      "  Using cached xgboost-0.90.tar.gz (676 kB)\n",
      "\u001b[31m    ERROR: Command errored out with exit status 1:\n",
      "     command: /Users/andrewbradbury/opt/anaconda3/bin/python -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '\"'\"'/private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/setup.py'\"'\"'; __file__='\"'\"'/private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/setup.py'\"'\"';f = getattr(tokenize, '\"'\"'open'\"'\"', open)(__file__) if os.path.exists(__file__) else io.StringIO('\"'\"'from setuptools import setup; setup()'\"'\"');code = f.read().replace('\"'\"'\\r\\n'\"'\"', '\"'\"'\\n'\"'\"');f.close();exec(compile(code, __file__, '\"'\"'exec'\"'\"'))' egg_info --egg-base /private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-pip-egg-info-1yajt2as\n",
      "         cwd: /private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/\n",
      "    Complete output (29 lines):\n",
      "    ++ pwd\n",
      "    + oldpath=/private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d\n",
      "    + cd ./xgboost/\n",
      "    + echo darwin21\n",
      "    + grep -q darwin\n",
      "    + LIB_XGBOOST=libxgboost.dylib\n",
      "    + which g++-5\n",
      "    + which g++-7\n",
      "    + which g++-8\n",
      "    + which clang++\n",
      "    /usr/bin/clang++\n",
      "    + export CC=clang\n",
      "    + CC=clang\n",
      "    + export CXX=clang++\n",
      "    + CXX=clang++\n",
      "    + make clean\n",
      "    xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun\n",
      "    Traceback (most recent call last):\n",
      "      File \"<string>\", line 1, in <module>\n",
      "      File \"/private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/setup.py\", line 42, in <module>\n",
      "        LIB_PATH = libpath['find_lib_path']()\n",
      "      File \"/private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/xgboost/libpath.py\", line 45, in find_lib_path\n",
      "        raise XGBoostLibraryNotFound(\n",
      "    XGBoostLibraryNotFound: Cannot find XGBoost Library in the candidate path, did you install compilers and run build.sh in root path?\n",
      "    List of candidates:\n",
      "    /private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/xgboost/libxgboost.dylib\n",
      "    /private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/xgboost/../../lib/libxgboost.dylib\n",
      "    /private/var/folders/lj/0v8r95s16slg9fk5wcvm85f80000gn/T/pip-install-ku__jd76/xgboost_675fb92963c34b7db7594bd046e6f23d/xgboost/./lib/libxgboost.dylib\n",
      "    /Users/andrewbradbury/opt/anaconda3/xgboost/libxgboost.dylib\n",
      "    ----------------------------------------\u001b[0m\n",
      "\u001b[33mWARNING: Discarding https://files.pythonhosted.org/packages/96/84/4e2cae6247f397f83d8adc5c2a2a0c5d7d790a14a4c7400ff6574586f589/xgboost-0.90.tar.gz#sha256=d69f90d61a63e8889fd39a31ad00c629bac1ca627f8406b9b6d4594c9e29ab84 (from https://pypi.org/simple/xgboost/) (requires-python:>=3.4). Command errored out with exit status 1: python setup.py egg_info Check the logs for full command output.\u001b[0m\n",
      "\u001b[31mERROR: Could not find a version that satisfies the requirement xgboost==0.90 (from versions: 0.4a12, 0.4a13, 0.4a14, 0.4a15, 0.4a18, 0.4a19, 0.4a20, 0.4a21, 0.4a22, 0.4a23, 0.4a24, 0.4a25, 0.4a26, 0.4a27, 0.4a28, 0.4a29, 0.4a30, 0.6a1, 0.6a2, 0.7.post3, 0.7.post4, 0.71, 0.72.1, 0.80, 0.81, 0.82, 0.90, 1.0.0rc1, 1.0.0rc2, 1.0.0, 1.0.1, 1.0.2, 1.1.0rc1, 1.1.0rc2, 1.1.0, 1.1.1, 1.2.0rc1, 1.2.0rc2, 1.2.0rc2+0089a0e6bf028cd15df3d3227d295fdce72a6706, 1.2.0, 1.2.1, 1.3.0rc1, 1.3.0.post0, 1.3.1, 1.3.2, 1.3.3, 1.4.0rc1, 1.4.0, 1.4.1, 1.4.2, 1.5.0rc1, 1.5.0, 1.5.1, 1.5.2, 1.6.0rc1, 1.6.0, 1.6.1)\u001b[0m\n",
      "\u001b[31mERROR: No matching distribution found for xgboost==0.90\u001b[0m\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install xgboost==0.90"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "XGBRegressor(base_score=0.5, booster='gbtree', callbacks=None,\n",
      "             colsample_bylevel=1, colsample_bynode=1, colsample_bytree=1,\n",
      "             early_stopping_rounds=None, enable_categorical=False,\n",
      "             eval_metric=None, gamma=0, gpu_id=-1, grow_policy='depthwise',\n",
      "             importance_type=None, interaction_constraints='',\n",
      "             learning_rate=0.300000012, max_bin=256, max_cat_to_onehot=4,\n",
      "             max_delta_step=0, max_depth=6, max_leaves=0, min_child_weight=1,\n",
      "             missing=nan, monotone_constraints='()', n_estimators=200, n_jobs=0,\n",
      "             num_parallel_tree=1, predictor='auto', random_state=0, reg_alpha=0,\n",
      "             reg_lambda=1, ...)\n"
     ]
    }
   ],
   "source": [
    "# create and and fit it to our training dataset\n",
    "from xgboost import XGBRegressor\n",
    "xgb = XGBRegressor(n_estimators=200)\n",
    "model = xgb.fit(X_train, y_train)\n",
    "print(model)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "prediction = xgb.predict(X_test)[1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[23:46:48] WARNING: /Users/runner/work/xgboost/xgboost/python-package/build/temp.macosx-10.9-x86_64-3.7/xgboost/src/objective/regression_obj.cu:203: reg:linear is now deprecated in favor of reg:squarederror.\n",
      "RMSE :  11.647464\n"
     ]
    }
   ],
   "source": [
    "# root-mean-squared error (RMSE)\n",
    "# plot a difference between the estimated and actual values of a parameter of the mode\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import xgboost as xg\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_squared_error as MSE\n",
    "# Instantiation\n",
    "xgb_r = xg.XGBRegressor(objective ='reg:linear',\n",
    "                  n_estimators = 10, seed = 123)\n",
    "  \n",
    "# Fitting the model\n",
    "xgb_r.fit(X_train,y_train)\n",
    "  \n",
    "# Predict the model\n",
    "pred = xgb_r.predict(X_test)\n",
    "  \n",
    "# RMSE Computation\n",
    "rmse = np.sqrt(MSE(y_test, pred))\n",
    "print(\"RMSE : % f\" %(rmse))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9867077674296928"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# outstanding fit to the model through grid search\n",
    "grid_search.best_score_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "# now through grid search regressor\n",
    "xgb = XGBRegressor(learning_rate=0.1, n_estimators=140, max_depth=4,\n",
    "                    subsample=0.8, colsample_bytree=0.8,objective= 'binary:logistic', \n",
    "                    nthread=4, scale_pos_weight=1,seed=27, min_child_weight=10 )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[23:47:02] WARNING: /Users/runner/work/xgboost/xgboost/python-package/build/temp.macosx-10.9-x86_64-3.7/xgboost/src/objective/regression_obj.cu:203: reg:linear is now deprecated in favor of reg:squarederror.\n",
      "RMSE :  11.647464\n"
     ]
    }
   ],
   "source": [
    "# repeat of finding RMSE\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import xgboost as xg\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.metrics import mean_squared_error as MSE\n",
    "# Instantiation\n",
    "xgb_r = xg.XGBRegressor(objective ='reg:linear',\n",
    "                  n_estimators = 10, seed = 123)\n",
    "  \n",
    "# Fitting the model\n",
    "xgb_r.fit(X_train,y_train)\n",
    "  \n",
    "# Predict the model\n",
    "pred = xgb_r.predict(X_test)\n",
    "  \n",
    "# RMSE Computation\n",
    "rmse = np.sqrt(MSE(y_test, pred))\n",
    "print(\"RMSE : % f\" %(rmse))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MAE: -5.307 (0.786)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "HistGradientBoostingRegressor()"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#  MAE: forcast difference from the true value\n",
    "# histogram-based gradient boosting for regression in scikit-learn\n",
    "from numpy import mean\n",
    "from numpy import std\n",
    "from sklearn.datasets import make_regression\n",
    "from sklearn.experimental import enable_hist_gradient_boosting\n",
    "from sklearn.ensemble import HistGradientBoostingRegressor\n",
    "from sklearn.model_selection import cross_val_score\n",
    "from sklearn.model_selection import RepeatedKFold\n",
    "from matplotlib import pyplot\n",
    "model = HistGradientBoostingRegressor()\n",
    "cv = RepeatedKFold(n_splits=10, n_repeats=5, random_state=1)\n",
    "n_scores = cross_val_score(model, X, y, scoring='neg_mean_absolute_error', cv=cv, n_jobs=-1, error_score='raise')\n",
    "print('MAE: %.3f (%.3f)' % (mean(n_scores), std(n_scores)))\n",
    "# fit the model on the whole dataset\n",
    "model = HistGradientBoostingRegressor()\n",
    "model.fit(X, y)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-2.1947360090446577"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# RMSE/MAE=0\n",
    "11.647464 / -5.307"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "HistGradientBoostingRegressor()"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1000, 4) (1000,)\n"
     ]
    }
   ],
   "source": [
    "# test regression dataset\n",
    "from sklearn.datasets import make_regression\n",
    "# summarize the dataset\n",
    "print(X.shape, y.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "MAE: -4.600 (0.411)\n"
     ]
    }
   ],
   "source": [
    "# evaluate gradient boosting\n",
    "from numpy import mean\n",
    "from numpy import std\n",
    "from sklearn.datasets import make_regression\n",
    "from sklearn.model_selection import cross_val_score\n",
    "from sklearn.model_selection import RepeatedKFold\n",
    "from sklearn.ensemble import GradientBoostingRegressor\n",
    "# define the model\n",
    "model = GradientBoostingRegressor()\n",
    "# define the evaluation procedure\n",
    "cv = RepeatedKFold(n_splits=10, n_repeats=3, random_state=1)\n",
    "# evaluate the model\n",
    "n_scores = cross_val_score(model, X, y, scoring='neg_mean_absolute_error', cv=cv, n_jobs=-1)\n",
    "# report performance\n",
    "print('MAE: %.3f (%.3f)' % (mean(n_scores), std(n_scores)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-0.18650265804137578"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# RMSE/MAE=0 \n",
    "11.647464 / -62.452"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Feature: 0, Score: 0.01485\n",
      "Feature: 1, Score: 0.03713\n",
      "Feature: 2, Score: 0.13332\n",
      "Feature: 3, Score: 0.27545\n",
      "Feature: 4, Score: 0.13665\n",
      "Feature: 5, Score: 0.01559\n",
      "Feature: 6, Score: 0.18713\n",
      "Feature: 7, Score: 0.04235\n",
      "Feature: 8, Score: 0.13834\n",
      "Feature: 9, Score: 0.01920\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# xgboost\n",
    "from xgboost import XGBRegressor\n",
    "from matplotlib import pyplot\n",
    "# define the model\n",
    "model = XGBRegressor()\n",
    "# fit the model\n",
    "model.fit(X, y)\n",
    "# get importance\n",
    "importance = model.feature_importances_\n",
    "# summarize feature importance\n",
    "for i,v in enumerate(importance):\n",
    "    print('Feature: %0d, Score: %.5f' % (i,v))\n",
    "# plot feature importance\n",
    "pyplot.bar([x for x in range(len(importance))], importance)\n",
    "pyplot.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Feature: 0, Score: 0.03285\n",
      "Feature: 1, Score: 0.04641\n",
      "Feature: 2, Score: 0.03498\n",
      "Feature: 3, Score: 0.07102\n",
      "Feature: 4, Score: 0.03730\n",
      "Feature: 5, Score: 0.04246\n",
      "Feature: 6, Score: 0.05326\n",
      "Feature: 7, Score: 0.04081\n",
      "Feature: 8, Score: 0.04264\n",
      "Feature: 9, Score: 0.02130\n"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# knn\n",
    "from sklearn.neighbors import KNeighborsRegressor\n",
    "from sklearn.inspection import permutation_importance\n",
    "from matplotlib import pyplot\n",
    "# define dataset\n",
    "# define the model\n",
    "model = KNeighborsRegressor()\n",
    "# fit the model\n",
    "model.fit(X, y)\n",
    "# perform permutation importance\n",
    "results = permutation_importance(model, X, y, scoring='neg_mean_squared_error')\n",
    "# get importance\n",
    "importance = results.importances_mean\n",
    "# summarize feature importance\n",
    "for i,v in enumerate(importance):\n",
    "    print('Feature: %0d, Score: %.5f' % (i,v))\n",
    "# plot feature importance\n",
    "pyplot.bar([x for x in range(len(importance))], importance)\n",
    "pyplot.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
